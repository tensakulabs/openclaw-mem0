<svg xmlns="http://www.w3.org/2000/svg" width="960" height="620" viewBox="0 0 960 620">
  <defs>
    <style>
      text { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    </style>
    <marker id="arr" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#9ca3af"/>
    </marker>
    <marker id="arr-green" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#16a34a"/>
    </marker>
    <marker id="arr-blue" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#3b82f6"/>
    </marker>
    <marker id="arr-red" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#ef4444"/>
    </marker>
    <filter id="sh" x="-3%" y="-3%" width="106%" height="110%">
      <feDropShadow dx="0" dy="1" stdDeviation="2" flood-opacity="0.06"/>
    </filter>
  </defs>

  <rect width="960" height="620" fill="#ffffff" rx="0"/>

  <!-- ===== TOP ROW: User → Agent → Response ===== -->
  <rect x="60" y="36" width="140" height="60" rx="10" fill="#fff7ed" stroke="#f97316" stroke-width="1.5" filter="url(#sh)"/>
  <text x="130" y="62" text-anchor="middle" font-size="15" font-weight="600" fill="#ea580c">User</text>
  <text x="130" y="80" text-anchor="middle" font-size="10" fill="#9a3412">Message</text>

  <line x1="204" y1="66" x2="298" y2="66" stroke="#9ca3af" stroke-width="1.5" marker-end="url(#arr)"/>

  <rect x="302" y="24" width="260" height="84" rx="10" fill="#f0fdf4" stroke="#22c55e" stroke-width="1.5" filter="url(#sh)"/>
  <text x="432" y="52" text-anchor="middle" font-size="15" font-weight="600" fill="#16a34a">OpenClaw Agent</text>
  <text x="432" y="70" text-anchor="middle" font-size="10" fill="#6b7280">(processes with memory context)</text>
  <text x="432" y="86" text-anchor="middle" font-size="9" fill="#9ca3af">5 memory tools available</text>

  <line x1="566" y1="66" x2="656" y2="66" stroke="#9ca3af" stroke-width="1.5" marker-end="url(#arr)"/>

  <rect x="660" y="36" width="140" height="60" rx="10" fill="#f0fdf4" stroke="#22c55e" stroke-width="1.5" filter="url(#sh)"/>
  <text x="730" y="62" text-anchor="middle" font-size="15" font-weight="600" fill="#16a34a">Response</text>
  <text x="730" y="80" text-anchor="middle" font-size="10" fill="#166534">with context</text>

  <!-- ===== BIDIRECTIONAL ARROWS: Agent ↔ Plugin ===== -->
  <line x1="400" y1="112" x2="400" y2="156" stroke="#9ca3af" stroke-width="1.5" marker-end="url(#arr)"/>
  <text x="390" y="140" text-anchor="end" font-size="9" font-weight="500" fill="#3b82f6">conversation</text>

  <line x1="464" y1="156" x2="464" y2="112" stroke="#16a34a" stroke-width="1.5" marker-end="url(#arr-green)"/>
  <text x="474" y="140" text-anchor="start" font-size="9" font-weight="500" fill="#16a34a">inject memories</text>

  <!-- ===== PLUGIN CONTAINER ===== -->
  <rect x="60" y="160" width="740" height="270" rx="12" fill="#fffbeb" stroke="#fbbf24" stroke-width="1.5" filter="url(#sh)"/>
  <text x="430" y="185" text-anchor="middle" font-size="15" font-weight="700" fill="#d97706">openclaw-mem0 plugin</text>

  <!-- Row 1: Auto-Recall + Auto-Capture side by side -->
  <rect x="90" y="200" width="220" height="52" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="200" y="222" text-anchor="middle" font-size="13" font-weight="600" fill="#2563eb">Auto-Recall</text>
  <text x="200" y="238" text-anchor="middle" font-size="9" fill="#1d4ed8">(before_agent_start)</text>

  <rect x="340" y="200" width="220" height="52" rx="8" fill="#fef2f2" stroke="#ef4444" stroke-width="1.5"/>
  <text x="450" y="222" text-anchor="middle" font-size="13" font-weight="600" fill="#dc2626">Auto-Capture</text>
  <text x="450" y="238" text-anchor="middle" font-size="9" fill="#991b1b">(agent_end)</text>

  <!-- Row 2: Short-Term + Long-Term Memory side by side -->
  <rect x="90" y="280" width="220" height="52" rx="8" fill="#fff7ed" stroke="#f97316" stroke-width="1.5"/>
  <text x="200" y="302" text-anchor="middle" font-size="13" font-weight="600" fill="#ea580c">Short-Term Memory</text>
  <text x="200" y="318" text-anchor="middle" font-size="9" fill="#9a3412">session-scoped (run_id)</text>

  <rect x="340" y="280" width="220" height="52" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="450" y="302" text-anchor="middle" font-size="13" font-weight="600" fill="#2563eb">Long-Term Memory</text>
  <text x="450" y="318" text-anchor="middle" font-size="9" fill="#1d4ed8">user-scoped (user_id)</text>

  <!-- Arrows: Recall → both memory scopes (dashed, search) -->
  <line x1="160" y1="256" x2="160" y2="276" stroke="#3b82f6" stroke-width="1.2" stroke-dasharray="4,3" marker-end="url(#arr-blue)"/>
  <line x1="240" y1="256" x2="390" y2="276" stroke="#3b82f6" stroke-width="1.2" stroke-dasharray="4,3" marker-end="url(#arr-blue)"/>
  <text x="148" y="270" text-anchor="end" font-size="9" font-weight="500" fill="#3b82f6">search</text>

  <!-- Arrows: Capture → both memory scopes (solid, store) -->
  <line x1="410" y1="256" x2="240" y2="276" stroke="#ef4444" stroke-width="1.2" marker-end="url(#arr-red)"/>
  <line x1="490" y1="256" x2="490" y2="276" stroke="#ef4444" stroke-width="1.2" marker-end="url(#arr-red)"/>
  <text x="502" y="270" text-anchor="start" font-size="9" font-weight="500" fill="#ef4444">store</text>

  <!-- Agent Tools panel -->
  <rect x="600" y="200" width="180" height="210" rx="8" fill="#f9fafb" stroke="#d1d5db" stroke-width="1"/>
  <text x="690" y="222" text-anchor="middle" font-size="12" font-weight="600" fill="#374151">Agent Tools</text>
  <line x1="610" y1="230" x2="770" y2="230" stroke="#e5e7eb" stroke-width="1"/>

  <text x="620" y="250" font-size="10" fill="#4b5563" font-family="ui-monospace, monospace">memory_search</text>
  <text x="620" y="268" font-size="10" fill="#4b5563" font-family="ui-monospace, monospace">memory_list</text>
  <text x="620" y="286" font-size="10" fill="#4b5563" font-family="ui-monospace, monospace">memory_store</text>
  <text x="620" y="304" font-size="10" fill="#4b5563" font-family="ui-monospace, monospace">memory_get</text>
  <text x="620" y="322" font-size="10" fill="#4b5563" font-family="ui-monospace, monospace">memory_forget</text>

  <line x1="610" y1="332" x2="770" y2="332" stroke="#e5e7eb" stroke-width="1"/>
  <text x="620" y="352" font-size="9" fill="#7c3aed">scope: session | long-term | all</text>
  <text x="620" y="370" font-size="9" fill="#ea580c">longTerm: true | false</text>

  <!-- Connecting line: Agent Tools to Agent (via plugin boundary) -->
  <line x1="690" y1="160" x2="690" y2="196" stroke="#d1d5db" stroke-width="1" stroke-dasharray="4,3"/>
  <path d="M 690 156 L 560 108" fill="none" stroke="#d1d5db" stroke-width="1" stroke-dasharray="4,3"/>
  <text x="640" y="148" text-anchor="middle" font-size="8" fill="#9ca3af">exposed to agent</text>

  <!-- ===== ARROW: Plugin → Mem0 ===== -->
  <line x1="430" y1="434" x2="430" y2="470" stroke="#9ca3af" stroke-width="1.5" marker-end="url(#arr)"/>
  <text x="440" y="456" text-anchor="start" font-size="9" font-weight="500" fill="#6b7280">store &amp; search</text>

  <!-- ===== MEM0 BOX ===== -->
  <rect x="280" y="474" width="300" height="70" rx="12" fill="#eff6ff" stroke="#3b82f6" stroke-width="2" filter="url(#sh)"/>
  <text x="430" y="504" text-anchor="middle" font-size="18" font-weight="700" fill="#1d4ed8">Mem0</text>
  <text x="430" y="524" text-anchor="middle" font-size="11" fill="#3b82f6">(Platform or Self-hosted OSS)</text>

  <!-- ===== LEGEND ===== -->
  <rect x="60" y="568" width="740" height="36" rx="6" fill="#f9fafb" stroke="#e5e7eb" stroke-width="1"/>

  <rect x="84" y="581" width="10" height="10" rx="2" fill="#3b82f6"/>
  <text x="100" y="590" font-size="9" fill="#4b5563">Auto-Recall / Long-Term</text>

  <rect x="240" y="581" width="10" height="10" rx="2" fill="#ef4444"/>
  <text x="256" y="590" font-size="9" fill="#4b5563">Auto-Capture</text>

  <rect x="348" y="581" width="10" height="10" rx="2" fill="#f97316"/>
  <text x="364" y="590" font-size="9" fill="#4b5563">Short-Term (run_id)</text>

  <rect x="490" y="581" width="10" height="10" rx="2" fill="#22c55e"/>
  <text x="506" y="590" font-size="9" fill="#4b5563">Memory Injection</text>

  <line x1="630" y1="586" x2="650" y2="586" stroke="#3b82f6" stroke-width="1.2" stroke-dasharray="4,3"/>
  <text x="656" y="590" font-size="9" fill="#4b5563">Search flow</text>

  <line x1="730" y1="586" x2="750" y2="586" stroke="#ef4444" stroke-width="1.2"/>
  <text x="756" y="590" font-size="9" fill="#4b5563">Store flow</text>
</svg>
